#pragma once

#include "target/artnetnode/target.h"

#define STM32_GPIO_CONFIG \
{ \
    GPIO_CONFIG_PORT( /* PORTA */ \
        /* PA 0 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* unmapped */ \
        /* PA 1 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* ETH_RMII_REF_CLK */ \
        /* PA 2 */ MODE_INPUT, CNF_IN_PULL, INITCTL_SET, INITVAL_HIGH, /* ETH_MDIO */ \
        /* PA 3 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* USART2_RX */ \
        /* PA 4 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* unmapped */ \
        /* PA 5 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* unmapped */ \
        /* PA 6 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* unmapped */ \
        /* PA 7 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* ETH_RMII_CRS_DV */ \
        /* PA 8 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* unmapped */ \
        /* PA 9 */ MODE_2MHZ, CNF_AF_PUSHPULL, INITCTL_SET, INITVAL_HIGH, /* USART1_TX */ \
        /* PA10 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* USART2_RX */ \
        /* PA11 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* OTG_FS_DM */ \
        /* PA12 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* OTG_FS_DP */ \
        /* PA13 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* SWDIO */ \
        /* PA14 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* SWCLK */ \
        /* PA15 */ MODE_INPUT, CNF_IN_PULL, INITCTL_SET, INITVAL_HIGH, /* IRQ */ \
    ), \
    GPIO_CONFIG_PORT( /* PORTB */ \
        /* PB 0 */ MODE_2MHZ, CNF_OUT_PUSHPULL, INITCTL_SET, INITVAL_LOW, /* DMX4 OE */ \
        /* PB 1 */ MODE_2MHZ, CNF_OUT_PUSHPULL, INITCTL_SET, INITVAL_LOW, /* DMX3 OE */ \
        /* PB 2 */ MODE_2MHZ, CNF_OUT_PUSHPULL, INITCTL_SET, INITVAL_LOW, /* DMX1 OE */ \
        /* PB 3 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* SPI1_SCK */ \
        /* PB 4 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* SPI1_MISO */ \
        /* PB 5 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* SPI1_MOSI */ \
        /* PB 6 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* I2C1_SCL */ \
        /* PB 7 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* I2C1_SDA */ \
        /* PB 8 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* unmapped */ \
        /* PB 9 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* unmapped */ \
        /* PB10 */ MODE_2MHZ, CNF_AF_PUSHPULL, INITCTL_SET, INITVAL_HIGH, /* USART3_TX */ \
        /* PB11 */ MODE_50MHZ, CNF_AF_PUSHPULL, INITCTL_SET, INITVAL_LOW, /* ETH_RMII_TX_EN */ \
        /* PB12 */ MODE_50MHZ, CNF_AF_PUSHPULL, INITCTL_SET, INITVAL_LOW, /* ETH_RMII_TXD0 */ \
        /* PB13 */ MODE_50MHZ, CNF_AF_PUSHPULL, INITCTL_SET, INITVAL_LOW, /* ETH_RMII_TXD1 */ \
        /* PB14 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* OTG_HS_DM */ \
        /* PB15 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* OTG_HS_DP */ \
    ), \
    GPIO_CONFIG_PORT( /* PORTC */ \
        /* PC 0 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* User button */ \
        /* PC 1 */ MODE_2MHZ, CNF_OUT_PUSHPULL, INITCTL_SET, INITVAL_LOW, /* ETH_MDC */ \
        /* PC 2 */ MODE_2MHZ, CNF_OUT_PUSHPULL, INITCTL_SET, INITVAL_HIGH, /* SPI flash CS */ \
        /* PC 3 */ MODE_2MHZ, CNF_OUT_PUSHPULL, INITCTL_SET, INITVAL_HIGH, /* microSD card CS */ \
        /* PC 4 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* ETH_RMII_RXD0 */ \
        /* PC 5 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* ETH_RMII_RXD1 */ \
        /* PC 6 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* unmapped */ \
        /* PC 7 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* unmapped */ \
        /* PC 8 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* unmapped */ \
        /* PC 9 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* unmapped */ \
        /* PC10 */ MODE_2MHZ, CNF_AF_PUSHPULL, INITCTL_SET, INITVAL_HIGH, /* UART4_TX */ \
        /* PC11 */ MODE_2MHZ, CNF_OUT_PUSHPULL, INITCTL_SET, INITVAL_LOW, /* DMX5 OE */ \
        /* PC12 */ MODE_2MHZ, CNF_AF_PUSHPULL, INITCTL_SET, INITVAL_HIGH, /* UART5_TX */ \
        /* PC13 */ MODE_2MHZ, CNF_OUT_PUSHPULL, INITCTL_SET, INITVAL_LOW, /* DMX2 OE */ \
        /* PC14 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* OSC32_IN */ \
        /* PC15 */ MODE_INPUT, CNF_IN_FLOATING, INITCTL_SET, INITVAL_LOW, /* OSC32_OUT */ \
    ), \
}

//TODO #define DMX_IN_CHANNELS 5
//TODO #define DMX_OUT_CHANNELS 4
#define DMX_IN_CHANNELS 4
#define DMX_OUT_CHANNELS 3

#define STM32_BITBANG_MDIO
#define STM32_ENABLE_SPI
#define STM32_ENABLE_ETHERNET
#define STM32_ENABLE_CRC32
#include "board/flexperiment/mini/f107/target.h"

#define SPIFLASH_SUPPORT_W25Q80BV
